<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, user-scalable=no">
        <script src="https://unpkg.com/@cmdcode/tapscript@1.4.0"></script>
        <script src="https://bundle.run/noble-secp256k1@1.2.14"></script>
        <script>
            var bytesToHex = bytes => bytes.reduce( ( str, byte ) => str + byte.toString( 16 ).padStart( 2, "0" ), "" );
            var hexToBytes = hex => Uint8Array.from( hex.match( /.{1,2}/g ).map( byte => parseInt( byte, 16 ) ) );
            var firstnames = ["Aaran", "Aaren", "Aarez", "Aarman", "Aaron", "Aaron-James", "Aarron", "Aaryan", "Aaryn", "Aayan", "Aazaan", "Abaan", "Abbas", "Abdallah", "Abdalroof", "Abdihakim", "Abdirahman", "Abdisalam", "Abdul", "Abdul-Aziz", "Abdulbasir", "Abdulkadir", "Abdulkarem", "Abdulkhader", "Abdullah", "Abdul-Majeed", "Abdulmalik", "Abdul-Rehman", "Abdur", "Abdurraheem", "Abdur-Rahman", "Abdur-Rehmaan", "Abel", "Abhinav", "Abhisumant", "Abid", "Abir", "Abraham", "Abu", "Abubakar", "Ace", "Adain", "Adam", "Adam-James", "Addison", "Addisson", "Adegbola", "Adegbolahan", "Aden", "Adenn", "Adie", "Adil", "Aditya", "Adnan", "Adrian", "Adrien", "Aedan", "Aedin", "Aedyn", "Aeron", "Afonso", "Ahmad", "Ahmed", "Ahmed-Aziz", "Ahoua", "Ahtasham", "Aiadan", "Aidan", "Aiden", "Aiden-Jack", "Aiden-Vee", "Aidian", "Aidy", "Ailin", "Aiman", "Ainsley", "Ainslie", "Airen", "Airidas", "Airlie", "AJ", "Ajay", "A-Jay", "Ajayraj", "Akan", "Akram", "Al", "Ala", "Alan", "Alanas", "Alasdair", "Alastair", "Alber", "Albert", "Albie", "Aldred", "Alec", "Aled", "Aleem", "Aleksandar", "Aleksander", "Aleksandr", "Aleksandrs", "Alekzander", "Alessandro", "Alessio", "Alex", "Alexander", "Alexei", "Alexx", "Alexzander", "Alf", "Alfee", "Alfie", "Alfred", "Alfy", "Alhaji", "Al-Hassan", "Ali", "Aliekber", "Alieu", "Alihaider", "Alisdair", "Alishan", "Alistair", "Alistar", "Alister", "Aliyaan", "Allan", "Allan-Laiton", "Allen", "Allesandro", "Allister", "Ally", "Alphonse", "Altyiab", "Alum", "Alvern", "Alvin", "Alyas", "Amaan", "Aman", "Amani", "Ambanimoh", "Ameer", "Amgad", "Ami", "Amin", "Amir", "Ammaar", "Ammar", "Ammer", "Amolpreet", "Amos", "Amrinder", "Amrit", "Amro", "Anay", "Andrea", "Andreas", "Andrei", "Andrejs", "Andrew", "Andy", "Anees", "Anesu", "Angel", "Angelo", "Angus", "Anir", "Anis", "Anish", "Anmolpreet", "Annan", "Anndra", "Anselm", "Anthony", "Anthony-John", "Antoine", "Anton", "Antoni", "Antonio", "Antony", "Antonyo", "Anubhav", "Aodhan", "Aon", "Aonghus", "Apisai", "Arafat", "Aran", "Arandeep", "Arann", "Aray", "Arayan", "Archibald", "Archie", "Arda", "Ardal", "Ardeshir", "Areeb", "Areez", "Aref", "Arfin", "Argyle", "Argyll", "Ari", "Aria", "Arian", "Arihant", "Aristomenis", "Aristotelis", "Arjuna", "Arlo", "Armaan", "Arman", "Armen", "Arnab", "Arnav", "Arnold", "Aron", "Aronas", "Arran", "Arrham", "Arron", "Arryn", "Arsalan", "Artem", "Arthur", "Artur", "Arturo", "Arun", "Arunas", "Arved", "Arya", "Aryan", "Aryankhan", "Aryian", "Aryn", "Asa", "Asfhan", "Ash", "Ashlee-jay", "Ashley", "Ashton", "Ashton-Lloyd", "Ashtyn", "Ashwin", "Asif", "Asim", "Aslam", "Asrar", "Ata", "Atal", "Atapattu", "Ateeq", "Athol", "Athon", "Athos-Carlos", "Atli", "Atom", "Attila", "Aulay", "Aun", "Austen", "Austin", "Avani", "Averon", "Avi", "Avinash", "Avraham", "Awais", "Awwal", "Axel", "Ayaan", "Ayan", "Aydan", "Ayden", "Aydin", "Aydon", "Ayman", "Ayomide", "Ayren", "Ayrton", "Aytug", "Ayub", "Ayyub", "Azaan", "Azedine", "Azeem", "Azim", "Aziz", "Azlan", "Azzam", "Azzedine", "Babatunmise", "Babur", "Bader", "Badr", "Badsha", "Bailee", "Bailey", "Bailie", "Bailley", "Baillie", "Baley", "Balian", "Banan", "Barath", "Barkley", "Barney", "Baron", "Barrie", "Barry", "Bartlomiej", "Bartosz", "Basher", "Basile", "Baxter", "Baye", "Bayley", "Beau", "Beinn", "Bekim", "Believe", "Ben", "Bendeguz", "Benedict", "Benjamin", "Benjamyn", "Benji", "Benn", "Bennett", "Benny", "Benoit", "Bentley", "Berkay", "Bernard", "Bertie", "Bevin", "Bezalel", "Bhaaldeen", "Bharath", "Bilal", "Bill", "Billy", "Binod", "Bjorn", "Blaike", "Blaine", "Blair", "Blaire", "Blake", "Blazej", "Blazey", "Blessing", "Blue", "Blyth", "Bo", "Boab", "Bob", "Bobby", "Bobby-Lee", "Bodhan", "Boedyn", "Bogdan", "Bohbi", "Bony", "Bowen", "Bowie", "Boyd", "Bracken", "Brad", "Bradan", "Braden", "Bradley", "Bradlie", "Bradly", "Brady", "Bradyn", "Braeden", "Braiden", "Brajan", "Brandan", "Branden", "Brandon", "Brandonlee", "Brandon-Lee", "Brandyn", "Brannan", "Brayden", "Braydon", "Braydyn", "Breandan", "Brehme", "Brendan", "Brendon", "Brendyn", "Breogan", "Bret", "Brett", "Briaddon", "Brian", "Brodi", "Brodie", "Brody", "Brogan", "Broghan", "Brooke", "Brooklin", "Brooklyn", "Bruce", "Bruin", "Bruno", "Brunon", "Bryan", "Bryce", "Bryden", "Brydon", "Brydon-Craig", "Bryn", "Brynmor", "Bryson", "Buddy", "Bully", "Burak", "Burhan", "Butali", "Butchi", "Byron", "Cabhan", "Cadan", "Cade", "Caden", "Cadon", "Cadyn", "Caedan", "Caedyn", "Cael", "Caelan", "Caelen", "Caethan", "Cahl", "Cahlum", "Cai", "Caidan", "Caiden", "Caiden-Paul", "Caidyn", "Caie", "Cailaen", "Cailean", "Caileb-John", "Cailin", "Cain", "Caine", "Cairn", "Cal", "Calan", "Calder", "Cale", "Calean", "Caleb", "Calen", "Caley", "Calib", "Calin", "Callahan", "Callan", "Callan-Adam", "Calley", "Callie", "Callin", "Callum", "Callun", "Callyn", "Calum", "Calum-James", "Calvin", "Cambell", "Camerin", "Cameron", "Campbel", "Campbell", "Camron", "Caolain", "Caolan", "Carl", "Carlo", "Carlos", "Carrich", "Carrick", "Carson", "Carter", "Carwyn", "Casey", "Casper", "Cassy", "Cathal", "Cator", "Cavan", "Cayden", "Cayden-Robert", "Cayden-Tiamo", "Ceejay", "Ceilan", "Ceiran", "Ceirin", "Ceiron", "Cejay", "Celik", "Cephas", "Cesar", "Cesare", "Chad", "Chaitanya", "Chang-Ha", "Charles", "Charley", "Charlie", "Charly", "Chase", "Che", "Chester", "Chevy", "Chi", "Chibudom", "Chidera", "Chimsom", "Chin", "Chintu", "Chiqal", "Chiron", "Chris", "Chris-Daniel", "Chrismedi", "Christian", "Christie", "Christoph", "Christopher", "Christopher-Lee", "Christy", "Chu", "Chukwuemeka", "Cian", "Ciann", "Ciar", "Ciaran", "Ciarian", "Cieran", "Cillian", "Cillin", "Cinar", "CJ", "C-Jay", "Clark", "Clarke", "Clayton", "Clement", "Clifford", "Clyde", "Cobain", "Coban", "Coben", "Cobi", "Cobie", "Coby", "Codey", "Codi", "Codie", "Cody", "Cody-Lee", "Coel", "Cohan", "Cohen", "Colby", "Cole", "Colin", "Coll", "Colm", "Colt", "Colton", "Colum", "Colvin", "Comghan", "Conal", "Conall", "Conan", "Conar", "Conghaile", "Conlan", "Conley", "Conli", "Conlin", "Conlly", "Conlon", "Conlyn", "Connal", "Connall", "Connan", "Connar", "Connel", "Connell", "Conner", "Connolly", "Connor", "Connor-David", "Conor", "Conrad", "Cooper", "Copeland", "Coray", "Corben", "Corbin", "Corey", "Corey-James", "Corey-Jay", "Cori", "Corie", "Corin", "Cormac", "Cormack", "Cormak", "Corran", "Corrie", "Cory", "Cosmo", "Coupar", "Craig", "Craig-James", "Crawford", "Creag", "Crispin", "Cristian", "Crombie", "Cruiz", "Cruz", "Cuillin", "Cullen", "Cullin", "Curtis", "Cyrus", "Daanyaal", "Daegan", "Daegyu", "Dafydd", "Dagon", "Dailey", "Daimhin", "Daithi", "Dakota", "Daksh", "Dale", "Dalong", "Dalton", "Damian", "Damien", "Damon", "Dan", "Danar", "Dane", "Danial", "Daniel", "Daniele", "Daniel-James", "Daniels", "Daniil", "Danish", "Daniyal", "Danniel", "Danny", "Dante", "Danyal", "Danyil", "Danys", "Daood", "Dara", "Darach", "Daragh", "Darcy", "D'arcy", "Dareh", "Daren", "Darien", "Darius", "Darl", "Darn", "Darrach", "Darragh", "Darrel", "Darrell", "Darren", "Darrie", "Darrius", "Darroch", "Darryl", "Darryn", "Darwyn", "Daryl", "Daryn", "Daud", "Daumantas", "Davi", "David", "David-Jay", "David-Lee", "Davie", "Davis", "Davy", "Dawid", "Dawson", "Dawud", "Dayem", "Daymian", "Deacon", "Deagan", "Dean", "Deano", "Decklan", "Declain", "Declan", "Declyan", "Declyn", "Dedeniseoluwa", "Deecan", "Deegan", "Deelan", "Deklain-Jaimes", "Del", "Demetrius", "Denis", "Deniss", "Dennan", "Dennin", "Dennis", "Denny", "Dennys", "Denon", "Denton", "Denver", "Denzel", "Deon", "Derek", "Derick", "Derin", "Dermot", "Derren", "Derrie", "Derrin", "Derron", "Derry", "Derryn", "Deryn", "Deshawn", "Desmond", "Dev", "Devan", "Devin", "Devlin", "Devlyn", "Devon", "Devrin", "Devyn", "Dex", "Dexter", "Dhani", "Dharam", "Dhavid", "Dhyia", "Diarmaid", "Diarmid", "Diarmuid", "Didier", "Diego", "Diesel", "Diesil", "Digby", "Dilan", "Dilano", "Dillan", "Dillon", "Dilraj", "Dimitri", "Dinaras", "Dion", "Dissanayake", "Dmitri", "Doire", "Dolan", "Domanic", "Domenico", "Domhnall", "Dominic", "Dominick", "Dominik", "Donald", "Donnacha", "Donnie", "Dorian", "Dougal", "Douglas", "Dougray", "Drakeo", "Dre", "Dregan", "Drew", "Dugald", "Duncan", "Duriel", "Dustin", "Dylan", "Dylan-Jack", "Dylan-James", "Dylan-John", "Dylan-Patrick", "Dylin", "Dyllan", "Dyllan-James", "Dyllon", "Eadie", "Eagann", "Eamon", "Eamonn", "Eason", "Eassan", "Easton", "Ebow", "Ed", "Eddie", "Eden", "Ediomi", "Edison", "Eduardo", "Eduards", "Edward", "Edwin", "Edwyn", "Eesa", "Efan", "Efe", "Ege", "Ehsan", "Ehsen", "Eiddon", "Eidhan", "Eihli", "Eimantas", "Eisa", "Eli", "Elias", "Elijah", "Eliot", "Elisau", "Eljay", "Eljon", "Elliot", "Elliott", "Ellis", "Ellisandro", "Elshan", "Elvin", "Elyan", "Emanuel", "Emerson", "Emil", "Emile", "Emir", "Emlyn", "Emmanuel", "Emmet", "Eng", "Eniola", "Enis", "Ennis", "Enrico", "Enrique", "Enzo", "Eoghain", "Eoghan", "Eoin", "Eonan", "Erdehan", "Eren", "Erencem", "Eric", "Ericlee", "Erik", "Eriz", "Ernie-Jacks", "Eroni", "Eryk", "Eshan", "Essa", "Esteban", "Ethan", "Etienne", "Etinosa", "Euan", "Eugene", "Evan", "Evann", "Ewan", "Ewen", "Ewing", "Exodi", "Ezekiel", "Ezra", "Fabian", "Fahad", "Faheem", "Faisal", "Faizaan", "Famara", "Fares", "Farhaan", "Farhan", "Farren", "Farzad", "Fauzaan", "Favour", "Fawaz", "Fawkes", "Faysal", "Fearghus", "Feden", "Felix", "Fergal", "Fergie", "Fergus", "Ferre", "Fezaan", "Fiachra", "Fikret", "Filip", "Filippo", "Finan", "Findlay", "Findlay-James", "Findlie", "Finlay", "Finley", "Finn", "Finnan", "Finnean", "Finnen", "Finnlay", "Finnley", "Fintan", "Fionn", "Firaaz", "Fletcher", "Flint", "Florin", "Flyn", "Flynn", "Fodeba", "Folarinwa", "Forbes", "Forgan", "Forrest", "Fox", "Francesco", "Francis", "Francisco", "Franciszek", "Franco", "Frank", "Frankie", "Franklin", "Franko", "Fraser", "Frazer", "Fred", "Freddie", "Frederick", "Fruin", "Fyfe", "Fyn", "Fynlay", "Fynn", "Gabriel", "Gallagher", "Gareth", "Garren", "Garrett", "Garry", "Gary", "Gavin", "Gavin-Lee", "Gene", "Geoff", "Geoffrey", "Geomer", "Geordan", "Geordie", "George", "Georgia", "Georgy", "Gerard", "Ghyll", "Giacomo", "Gian", "Giancarlo", "Gianluca", "Gianmarco", "Gideon", "Gil", "Gio", "Girijan", "Girius", "Gjan", "Glascott", "Glen", "Glenn", "Gordon", "Grady", "Graeme", "Graham", "Grahame", "Grant", "Grayson", "Greg", "Gregor", "Gregory", "Greig", "Griffin", "Griffyn", "Grzegorz", "Guang", "Guerin", "Guillaume", "Gurardass", "Gurdeep", "Gursees", "Gurthar", "Gurveer", "Gurwinder", "Gus", "Gustav", "Guthrie", "Guy", "Gytis", "Habeeb", "Hadji", "Hadyn", "Hagun", "Haiden", "Haider", "Hamad", "Hamid", "Hamish", "Hamza", "Hamzah", "Han", "Hansen", "Hao", "Hareem", "Hari", "Harikrishna", "Haris", "Harish", "Harjeevan", "Harjyot", "Harlee", "Harleigh", "Harley", "Harman", "Harnek", "Harold", "Haroon", "Harper", "Harri", "Harrington", "Harris", "Harrison", "Harry", "Harvey", "Harvie", "Harvinder", "Hasan", "Haseeb", "Hashem", "Hashim", "Hassan", "Hassanali", "Hately", "Havila", "Hayden", "Haydn", "Haydon", "Haydyn", "Hcen", "Hector", "Heddle", "Heidar", "Heini", "Hendri", "Henri", "Henry", "Herbert", "Heyden", "Hiro", "Hirvaansh", "Hishaam", "Hogan", "Honey", "Hong", "Hope", "Hopkin", "Hosea", "Howard", "Howie", "Hristomir", "Hubert", "Hugh", "Hugo", "Humza", "Hunter", "Husnain", "Hussain", "Hussan", "Hussnain", "Hussnan", "Hyden", "I", "Iagan", "Iain", "Ian", "Ibraheem", "Ibrahim", "Idahosa", "Idrees", "Idris", "Iestyn", "Ieuan", "Igor", "Ihtisham", "Ijay", "Ikechukwu", "Ikemsinachukwu", "Ilyaas", "Ilyas", "Iman", "Immanuel", "Inan", "Indy", "Ines", "Innes", "Ioannis", "Ireayomide", "Ireoluwa", "Irvin", "Irvine", "Isa", "Isaa", "Isaac", "Isaiah", "Isak", "Isher", "Ishwar", "Isimeli", "Isira", "Ismaeel", "Ismail", "Israel", "Issiaka", "Ivan", "Ivar", "Izaak", "J", "Jaay", "Jac", "Jace", "Jack", "Jacki", "Jackie", "Jack-James", "Jackson", "Jacky", "Jacob", "Jacques", "Jad", "Jaden", "Jadon", "Jadyn", "Jae", "Jagat", "Jago", "Jaheim", "Jahid", "Jahy", "Jai", "Jaida", "Jaiden", "Jaidyn", "Jaii", "Jaime", "Jai-Rajaram", "Jaise", "Jak", "Jake", "Jakey", "Jakob", "Jaksyn", "Jakub", "Jamaal", "Jamal", "Jameel", "Jameil", "James", "James-Paul", "Jamey", "Jamie", "Jan", "Jaosha", "Jardine", "Jared", "Jarell", "Jarl", "Jarno", "Jarred", "Jarvi", "Jasey-Jay", "Jasim", "Jaskaran", "Jason", "Jasper", "Jaxon", "Jaxson", "Jay", "Jaydan", "Jayden", "Jayden-James", "Jayden-Lee", "Jayden-Paul", "Jayden-Thomas", "Jaydn", "Jaydon", "Jaydyn", "Jayhan", "Jay-Jay", "Jayke", "Jaymie", "Jayse", "Jayson", "Jaz", "Jazeb", "Jazib", "Jazz", "Jean", "Jean-Lewis", "Jean-Pierre", "Jebadiah", "Jed", "Jedd", "Jedidiah", "Jeemie", "Jeevan", "Jeffrey", "Jensen", "Jenson", "Jensyn", "Jeremy", "Jerome", "Jeronimo", "Jerrick", "Jerry", "Jesse", "Jesuseun", "Jeswin", "Jevan", "Jeyun", "Jez", "Jia", "Jian", "Jiao", "Jimmy", "Jincheng", "JJ", "Joaquin", "Joash", "Jock", "Jody", "Joe", "Joeddy", "Joel", "Joey", "Joey-Jack", "Johann", "Johannes", "Johansson", "John", "Johnathan", "Johndean", "Johnjay", "John-Michael", "Johnnie", "Johnny", "Johnpaul", "John-Paul", "John-Scott", "Johnson", "Jole", "Jomuel", "Jon", "Jonah", "Jonatan", "Jonathan", "Jonathon", "Jonny", "Jonothan", "Jon-Paul", "Jonson", "Joojo", "Jordan", "Jordi", "Jordon", "Jordy", "Jordyn", "Jorge", "Joris", "Jorryn", "Josan", "Josef", "Joseph", "Josese", "Josh", "Joshiah", "Joshua", "Josiah", "Joss", "Jostelle", "Joynul", "Juan", "Jubin", "Judah", "Jude", "Jules", "Julian", "Julien", "Jun", "Junior", "Jura", "Justan", "Justin", "Justinas", "Kaan", "Kabeer", "Kabir", "Kacey", "Kacper", "Kade", "Kaden", "Kadin", "Kadyn", "Kaeden", "Kael", "Kaelan", "Kaelin", "Kaelum", "Kai", "Kaid", "Kaidan", "Kaiden", "Kaidinn", "Kaidyn", "Kaileb", "Kailin", "Kain", "Kaine", "Kainin", "Kainui", "Kairn", "Kaison", "Kaiwen", "Kajally", "Kajetan", "Kalani", "Kale", "Kaleb", "Kaleem", "Kal-el", "Kalen", "Kalin", "Kallan", "Kallin", "Kalum", "Kalvin", "Kalvyn", "Kameron", "Kames", "Kamil", "Kamran", "Kamron", "Kane", "Karam", "Karamvir", "Karandeep", "Kareem", "Karim", "Karimas", "Karl", "Karol", "Karson", "Karsyn", "Karthikeya", "Kasey", "Kash", "Kashif", "Kasim", "Kasper", "Kasra", "Kavin", "Kayam", "Kaydan", "Kayden", "Kaydin", "Kaydn", "Kaydyn", "Kaydyne", "Kayleb", "Kaylem", "Kaylum", "Kayne", "Kaywan", "Kealan", "Kealon", "Kean", "Keane", "Kearney", "Keatin", "Keaton", "Keavan", "Keayn", "Kedrick", "Keegan", "Keelan", "Keelin", "Keeman", "Keenan", "Keenan-Lee", "Keeton", "Kehinde", "Keigan", "Keilan", "Keir", "Keiran", "Keiren", "Keiron", "Keiryn", "Keison", "Keith", "Keivlin", "Kelam", "Kelan", "Kellan", "Kellen", "Kelso", "Kelum", "Kelvan", "Kelvin", "Ken", "Kenan", "Kendall", "Kendyn", "Kenlin", "Kenneth", "Kensey", "Kenton", "Kenyon", "Kenzeigh", "Kenzi", "Kenzie", "Kenzo", "Kenzy", "Keo", "Ker", "Kern", "Kerr", "Kevan", "Kevin", "Kevyn", "Kez", "Khai", "Khalan", "Khaleel", "Khaya", "Khevien", "Khizar", "Khizer", "Kia", "Kian", "Kian-James", "Kiaran", "Kiarash", "Kie", "Kiefer", "Kiegan", "Kienan", "Kier", "Kieran", "Kieran-Scott", "Kieren", "Kierin", "Kiern", "Kieron", "Kieryn", "Kile", "Killian", "Kimi", "Kingston", "Kinneil", "Kinnon", "Kinsey", "Kiran", "Kirk", "Kirwin", "Kit", "Kiya", "Kiyonari", "Kjae", "Klein", "Klevis", "Kobe", "Kobi", "Koby", "Koddi", "Koden", "Kodi", "Kodie", "Kody", "Kofi", "Kogan", "Kohen", "Kole", "Konan", "Konar", "Konnor", "Konrad", "Koray", "Korben", "Korbyn", "Korey", "Kori", "Korrin", "Kory", "Koushik", "Kris", "Krish", "Krishan", "Kriss", "Kristian", "Kristin", "Kristofer", "Kristoffer", "Kristopher", "Kruz", "Krzysiek", "Krzysztof", "Ksawery", "Ksawier", "Kuba", "Kurt", "Kurtis", "Kurtis-Jae", "Kyaan", "Kyan", "Kyde", "Kyden", "Kye", "Kyel", "Kyhran", "Kyie", "Kylan", "Kylar", "Kyle", "Kyle-Derek", "Kylian", "Kym", "Kynan", "Kyral", "Kyran", "Kyren", "Kyrillos", "Kyro", "Kyron", "Kyrran", "Lachlainn", "Lachlan", "Lachlann", "Lael", "Lagan", "Laird", "Laison", "Lakshya", "Lance", "Lancelot", "Landon", "Lang", "Lasse", "Latif", "Lauchlan", "Lauchlin", "Laughlan", "Lauren", "Laurence", "Laurie", "Lawlyn", "Lawrence", "Lawrie", "Lawson", "Layne", "Layton", "Lee", "Leigh", "Leigham", "Leighton", "Leilan", "Leiten", "Leithen", "Leland", "Lenin", "Lennan", "Lennen", "Lennex", "Lennon", "Lennox", "Lenny", "Leno", "Lenon", "Lenyn", "Leo", "Leon", "Leonard", "Leonardas", "Leonardo", "Lepeng", "Leroy", "Leven", "Levi", "Levon", "Levy", "Lewie", "Lewin", "Lewis", "Lex", "Leydon", "Leyland", "Leylann", "Leyton", "Liall", "Liam", "Liam-Stephen", "Limo", "Lincoln", "Lincoln-John", "Lincon", "Linden", "Linton", "Lionel", "Lisandro", "Litrell", "Liyonela-Elam", "LLeyton", "Lliam", "Lloyd", "Lloyde", "Loche", "Lochlan", "Lochlann", "Lochlan-Oliver", "Lock", "Lockey", "Logan", "Logann", "Logan-Rhys", "Loghan", "Lokesh", "Loki", "Lomond", "Lorcan", "Lorenz", "Lorenzo", "Lorne", "Loudon", "Loui", "Louie", "Louis", "Loukas", "Lovell", "Luc", "Luca", "Lucais", "Lucas", "Lucca", "Lucian", "Luciano", "Lucien", "Lucus", "Luic", "Luis", "Luk", "Luka", "Lukas", "Lukasz", "Luke", "Lukmaan", "Luqman", "Lyall", "Lyle", "Lyndsay", "Lysander", "Maanav", "Maaz", "Mac", "Macallum", "Macaulay", "Macauley", "Macaully", "Machlan", "Maciej", "Mack", "Mackenzie", "Mackenzy", "Mackie", "Macsen", "Macy", "Madaki", "Maddison", "Maddox", "Madison", "Madison-Jake", "Madox", "Mael", "Magnus", "Mahan", "Mahdi", "Mahmoud", "Maias", "Maison", "Maisum", "Maitlind", "Majid", "Makensie", "Makenzie", "Makin", "Maksim", "Maksymilian", "Malachai", "Malachi", "Malachy", "Malakai", "Malakhy", "Malcolm", "Malik", "Malikye", "Malo", "Ma'moon", "Manas", "Maneet", "Manmohan", "Manolo", "Manson", "Mantej", "Manuel", "Manus", "Marc", "Marc-Anthony", "Marcel", "Marcello", "Marcin", "Marco", "Marcos", "Marcous", "Marcquis", "Marcus", "Mario", "Marios", "Marius", "Mark", "Marko", "Markus", "Marley", "Marlin", "Marlon", "Maros", "Marshall", "Martin", "Marty", "Martyn", "Marvellous", "Marvin", "Marwan", "Maryk", "Marzuq", "Mashhood", "Mason", "Mason-Jay", "Masood", "Masson", "Matas", "Matej", "Mateusz", "Mathew", "Mathias", "Mathu", "Mathuyan", "Mati", "Matt", "Matteo", "Matthew", "Matthew-William", "Matthias", "Max", "Maxim", "Maximilian", "Maximillian", "Maximus", "Maxwell", "Maxx", "Mayeul", "Mayson", "Mazin", "Mcbride", "McCaulley", "McKade", "McKauley", "McKay", "McKenzie", "McLay", "Meftah", "Mehmet", "Mehraz", "Meko", "Melville", "Meshach", "Meyzhward", "Micah", "Michael", "Michael-Alexander", "Michael-James", "Michal", "Michat", "Micheal", "Michee", "Mickey", "Miguel", "Mika", "Mikael", "Mikee", "Mikey", "Mikhail", "Mikolaj", "Miles", "Millar", "Miller", "Milo", "Milos", "Milosz", "Mir", "Mirza", "Mitch", "Mitchel", "Mitchell", "Moad", "Moayd", "Mobeen", "Modoulamin", "Modu", "Mohamad", "Mohamed", "Mohammad", "Mohammad-Bilal", "Mohammed", "Mohanad", "Mohd", "Momin", "Momooreoluwa", "Montague", "Montgomery", "Monty", "Moore", "Moosa", "Moray", "Morgan", "Morgyn", "Morris", "Morton", "Moshy", "Motade", "Moyes", "Msughter", "Mueez", "Muhamadjavad", "Muhammad", "Muhammed", "Muhsin", "Muir", "Munachi", "Muneeb", "Mungo", "Munir", "Munmair", "Munro", "Murdo", "Murray", "Murrough", "Murry", "Musa", "Musse", "Mustafa", "Mustapha", "Muzammil", "Muzzammil", "Mykie", "Myles", "Mylo", "Nabeel", "Nadeem", "Nader", "Nagib", "Naif", "Nairn", "Narvic", "Nash", "Nasser", "Nassir", "Natan", "Nate", "Nathan", "Nathanael", "Nathanial", "Nathaniel", "Nathan-Rae", "Nawfal", "Nayan", "Neco", "Neil", "Nelson", "Neo", "Neshawn", "Nevan", "Nevin", "Ngonidzashe", "Nial", "Niall", "Nicholas", "Nick", "Nickhill", "Nicki", "Nickson", "Nicky", "Nico", "Nicodemus", "Nicol", "Nicolae", "Nicolas", "Nidhish", "Nihaal", "Nihal", "Nikash", "Nikhil", "Niki", "Nikita", "Nikodem", "Nikolai", "Nikos", "Nilav", "Niraj", "Niro", "Niven", "Noah", "Noel", "Nolan", "Noor", "Norman", "Norrie", "Nuada", "Nyah", "Oakley", "Oban", "Obieluem", "Obosa", "Odhran", "Odin", "Odynn", "Ogheneochuko", "Ogheneruno", "Ohran", "Oilibhear", "Oisin", "Ojima-Ojo", "Okeoghene", "Olaf", "Ola-Oluwa", "Olaoluwapolorimi", "Ole", "Olie", "Oliver", "Olivier", "Oliwier", "Ollie", "Olurotimi", "Oluwadamilare", "Oluwadamiloju", "Oluwafemi", "Oluwafikunayomi", "Oluwalayomi", "Oluwatobiloba", "Oluwatoni", "Omar", "Omri", "Oran", "Orin", "Orlando", "Orley", "Orran", "Orrick", "Orrin", "Orson", "Oryn", "Oscar", "Osesenagha", "Oskar", "Ossian", "Oswald", "Otto", "Owain", "Owais", "Owen", "Owyn", "Oz", "Ozzy", "Pablo", "Pacey", "Padraig", "Paolo", "Pardeepraj", "Parkash", "Parker", "Pascoe", "Pasquale", "Patrick", "Patrick-John", "Patrikas", "Patryk", "Paul", "Pavit", "Pawel", "Pawlo", "Pearce", "Pearse", "Pearsen", "Pedram", "Pedro", "Peirce", "Peiyan", "Pele", "Peni", "Peregrine", "Peter", "Phani", "Philip", "Philippos", "Phinehas", "Phoenix", "Phoevos", "Pierce", "Pierre-Antoine", "Pieter", "Pietro", "Piotr", "Porter", "Prabhjoit", "Prabodhan", "Praise", "Pranav", "Pravin", "Precious", "Prentice", "Presley", "Preston", "Preston-Jay", "Prinay", "Prince", "Prithvi", "Promise", "Puneetpaul", "Pushkar", "Qasim", "Qirui", "Quinlan", "Quinn", "Radmiras", "Raees", "Raegan", "Rafael", "Rafal", "Rafferty", "Rafi", "Raheem", "Rahil", "Rahim", "Rahman", "Raith", "Raithin", "Raja", "Rajab-Ali", "Rajan", "Ralfs", "Ralph", "Ramanas", "Ramit", "Ramone", "Ramsay", "Ramsey", "Rana", "Ranolph", "Raphael", "Rasmus", "Rasul", "Raul", "Raunaq", "Ravin", "Ray", "Rayaan", "Rayan", "Rayane", "Rayden", "Rayhan", "Raymond", "Rayne", "Rayyan", "Raza", "Reace", "Reagan", "Reean", "Reece", "Reed", "Reegan", "Rees", "Reese", "Reeve", "Regan", "Regean", "Reggie", "Rehaan", "Rehan", "Reice", "Reid", "Reigan", "Reilly", "Reily", "Reis", "Reiss", "Remigiusz", "Remo", "Remy", "Ren", "Renars", "Reng", "Rennie", "Reno", "Reo", "Reuben", "Rexford", "Reynold", "Rhein", "Rheo", "Rhett", "Rheyden", "Rhian", "Rhoan", "Rholmark", "Rhoridh", "Rhuairidh", "Rhuan", "Rhuaridh", "Rhudi", "Rhy", "Rhyan", "Rhyley", "Rhyon", "Rhys", "Rhys-Bernard", "Rhyse", "Riach", "Rian", "Ricards", "Riccardo", "Ricco", "Rice", "Richard", "Richey", "Richie", "Ricky", "Rico", "Ridley", "Ridwan", "Rihab", "Rihan", "Rihards", "Rihonn", "Rikki", "Riley", "Rio", "Rioden", "Rishi", "Ritchie", "Rivan", "Riyadh", "Riyaj", "Roan", "Roark", "Roary", "Rob", "Robbi", "Robbie", "Robbie-lee", "Robby", "Robert", "Robert-Gordon", "Robertjohn", "Robi", "Robin", "Rocco", "Roddy", "Roderick", "Rodrigo", "Roen", "Rogan", "Roger", "Rohaan", "Rohan", "Rohin", "Rohit", "Rokas", "Roman", "Ronald", "Ronan", "Ronan-Benedict", "Ronin", "Ronnie", "Rooke", "Roray", "Rori", "Rorie", "Rory", "Roshan", "Ross", "Ross-Andrew", "Rossi", "Rowan", "Rowen", "Roy", "Ruadhan", "Ruaidhri", "Ruairi", "Ruairidh", "Ruan", "Ruaraidh", "Ruari", "Ruaridh", "Ruben", "Rubhan", "Rubin", "Rubyn", "Rudi", "Rudy", "Rufus", "Rui", "Ruo", "Rupert", "Ruslan", "Russel", "Russell", "Ryaan", "Ryan", "Ryan-Lee", "Ryden", "Ryder", "Ryese", "Ryhs", "Rylan", "Rylay", "Rylee", "Ryleigh", "Ryley", "Rylie", "Ryo", "Ryszard", "Saad", "Sabeen", "Sachkirat", "Saffi", "Saghun", "Sahaib", "Sahbian", "Sahil", "Saif", "Saifaddine", "Saim", "Sajid", "Sajjad", "Salahudin", "Salman", "Salter", "Salvador", "Sam", "Saman", "Samar", "Samarjit", "Samatar", "Sambrid", "Sameer", "Sami", "Samir", "Sami-Ullah", "Samual", "Samuel", "Samuela", "Samy", "Sanaullah", "Sandro", "Sandy", "Sanfur", "Sanjay", "Santiago", "Santino", "Satveer", "Saul", "Saunders", "Savin", "Sayad", "Sayeed", "Sayf", "Scot", "Scott", "Scott-Alexander", "Seaan", "Seamas", "Seamus", "Sean", "Seane", "Sean-James", "Sean-Paul", "Sean-Ray", "Seb", "Sebastian", "Sebastien", "Selasi", "Seonaidh", "Sephiroth", "Sergei", "Sergio", "Seth", "Sethu", "Seumas", "Shaarvin", "Shadow", "Shae", "Shahmir", "Shai", "Shane", "Shannon", "Sharland", "Sharoz", "Shaughn", "Shaun", "Shaunpaul", "Shaun-Paul", "Shaun-Thomas", "Shaurya", "Shaw", "Shawn", "Shawnpaul", "Shay", "Shayaan", "Shayan", "Shaye", "Shayne", "Shazil", "Shea", "Sheafan", "Sheigh", "Shenuk", "Sher", "Shergo", "Sheriff", "Sherwyn", "Shiloh", "Shiraz", "Shreeram", "Shreyas", "Shyam", "Siddhant", "Siddharth", "Sidharth", "Sidney", "Siergiej", "Silas", "Simon", "Sinai", "Skye", "Sofian", "Sohaib", "Sohail", "Soham", "Sohan", "Sol", "Solomon", "Sonneey", "Sonni", "Sonny", "Sorley", "Soul", "Spencer", "Spondon", "Stanislaw", "Stanley", "Stefan", "Stefano", "Stefin", "Stephen", "Stephenjunior", "Steve", "Steven", "Steven-lee", "Stevie", "Stewart", "Stewarty", "Strachan", "Struan", "Stuart", "Su", "Subhaan", "Sudais", "Suheyb", "Suilven", "Sukhi", "Sukhpal", "Sukhvir", "Sulayman", "Sullivan", "Sultan", "Sung", "Sunny", "Suraj", "Surien", "Sweyn", "Syed", "Sylvain", "Symon", "Szymon", "Tadd", "Taddy", "Tadhg", "Taegan", "Taegen", "Tai", "Tait", "Taiwo", "Talha", "Taliesin", "Talon", "Talorcan", "Tamar", "Tamiem", "Tammam", "Tanay", "Tane", "Tanner", "Tanvir", "Tanzeel", "Taonga", "Tarik", "Tariq-Jay", "Tate", "Taylan", "Taylar", "Tayler", "Taylor", "Taylor-Jay", "Taylor-Lee", "Tayo", "Tayyab", "Tayye", "Tayyib", "Teagan", "Tee", "Teejay", "Tee-jay", "Tegan", "Teighen", "Teiyib", "Te-Jay", "Temba", "Teo", "Teodor", "Teos", "Terry", "Teydren", "Theo", "Theodore", "Thiago", "Thierry", "Thom", "Thomas", "Thomas-Jay", "Thomson", "Thorben", "Thorfinn", "Thrinei", "Thumbiko", "Tiago", "Tian", "Tiarnan", "Tibet", "Tieran", "Tiernan", "Timothy", "Timucin", "Tiree", "Tisloh", "Titi", "Titus", "Tiylar", "TJ", "Tjay", "T-Jay", "Tobey", "Tobi", "Tobias", "Tobie", "Toby", "Todd", "Tokinaga", "Toluwalase", "Tom", "Tomas", "Tomasz", "Tommi-Lee", "Tommy", "Tomson", "Tony", "Torin", "Torquil", "Torran", "Torrin", "Torsten", "Trafford", "Trai", "Travis", "Tre", "Trent", "Trey", "Tristain", "Tristan", "Troy", "Tubagus", "Turki", "Turner", "Ty", "Ty-Alexander", "Tye", "Tyelor", "Tylar", "Tyler", "Tyler-James", "Tyler-Jay", "Tyllor", "Tylor", "Tymom", "Tymon", "Tymoteusz", "Tyra", "Tyree", "Tyrnan", "Tyrone", "Tyson", "Ubaid", "Ubayd", "Uchenna", "Uilleam", "Umair", "Umar", "Umer", "Umut", "Urban", "Uri", "Usman", "Uzair", "Uzayr", "Valen", "Valentin", "Valentino", "Valery", "Valo", "Vasyl", "Vedantsinh", "Veeran", "Victor", "Victory", "Vinay", "Vince", "Vincent", "Vincenzo", "Vinh", "Vinnie", "Vithujan", "Vladimir", "Vladislav", "Vrishin", "Vuyolwethu", "Wabuya", "Wai", "Walid", "Wallace", "Walter", "Waqaas", "Warkhas", "Warren", "Warrick", "Wasif", "Wayde", "Wayne", "Wei", "Wen", "Wesley", "Wesley-Scott", "Wiktor", "Wilkie", "Will", "William", "William-John", "Willum", "Wilson", "Windsor", "Wojciech", "Woyenbrakemi", "Wyatt", "Wylie", "Wynn", "Xabier", "Xander", "Xavier", "Xiao", "Xida", "Xin", "Xue", "Yadgor", "Yago", "Yahya", "Yakup", "Yang", "Yanick", "Yann", "Yannick", "Yaseen", "Yasin", "Yasir", "Yassin", "Yoji", "Yong", "Yoolgeun", "Yorgos", "Youcef", "Yousif", "Youssef", "Yu", "Yuanyu", "Yuri", "Yusef", "Yusuf", "Yves", "Zaaine", "Zaak", "Zac", "Zach", "Zachariah", "Zacharias", "Zacharie", "Zacharius", "Zachariya", "Zachary", "Zachary-Marc", "Zachery", "Zack", "Zackary", "Zaid", "Zain", "Zaine", "Zaineddine", "Zainedin", "Zak", "Zakaria", "Zakariya", "Zakary", "Zaki", "Zakir", "Zakk", "Zamaar", "Zander", "Zane", "Zarran", "Zayd", "Zayn", "Zayne", "Ze", "Zechariah", "Zeek", "Zeeshan", "Zeid", "Zein", "Zen", "Zendel", "Zenith", "Zennon", "Zeph", "Zerah", "Zhen", "Zhi", "Zhong", "Zhuo", "Zi", "Zidane", "Zijie", "Zinedine", "Zion", "Zishan", "Ziya", "Ziyaan", "Zohaib", "Zohair", "Zoubaeir", "Zubair", "Zubayr", "Zuriel"];
            firstnames = firstnames.map( word => word.replaceAll( "-", " " ) );
            var capitalizeFirstLetter = val => String( val ).charAt( 0 ).toUpperCase() + String( val ).slice( 1 );
            var generateName = names => {
                var name = firstnames[ Math.floor( Math.random() * firstnames.length ) ];
                if ( names.includes( name ) ) return generateName( names );
                return name;
            }
            var waitSomeTime = num => new Promise( resolve => setTimeout( resolve, num ) );
        </script>
        <style>
            * {
                box-sizing: border-box;
                font-size: 1.15rem;
                font-family: Arial, sans-serif;
            }
            html {
                max-width: 800px;
                padding: 3rem 1rem;
                margin: auto;
                line-height: 1.25;
                padding: 0;
            }
            body {
                margin: 3rem 1rem;
                word-wrap: break-word;
            }
            h1 {
                font-size: 2rem;
            }
            h2 {
                font-size: 1.5rem;
            }
            input {
                line-height: 1.25;
                width: 100%;
                height: 1.8rem;
                font-size: 1.15rem;
                border: 1px solid grey;
            }
            .hidden {
                display: none !important;
            }
            .keys {
                text-align: center;
            }
            .keys h2 {
                text-align: left;
            }
            .user {
                margin: .5rem;
                display: inline-block;
                max-width: 12rem;
                border: 1px solid black;
                border-radius: 1rem;
                padding: 1rem;
                text-align: center;
                vertical-align: top;
            }
            .profile_pic img {
                width: 100%;
                background-color: white;
                border-radius: 50%;
            }
            .username {
                font-weight: bold;
            }
            @media screen and (max-width: 600px) {
            }
        </style>
        <script>
            var $ = document.querySelector.bind( document );
            var $$ = document.querySelectorAll.bind( document );
            var url_params = new URLSearchParams( window.location.search );
            var url_keys = url_params.keys();
            var $_GET = {}
            for ( var key of url_keys ) $_GET[ key ] = url_params.get( key );
        </script>
    </head>
    <body>
        <h1>Tornado factory</h1>
        <div class="loading hidden"><p>Loading...</p></div>
        <div class="welcome">
            <p>
                Welcome to tornado factory. Tornado factory is a bitcoin "channel factory" where many users can create payment channels without them all appearing in a transaction on the base layer. On this page you can try it out. Click the button below to get started.
            </p>
            <p><button class="start_tornado_factory">Start tornado factory</button></p>
        </div>
        <div class="part_2 hidden">
            <p>
                Your <span class="num_of_users"></span> users have been generated. Each one currently has 0 sats and they need <span class="per_user_amount"></span> sats to enter the channel factory and pay their share of the mining fee. We will now do an "initial transaction" that gives each user the money they need. Since you have <span class="num_of_users"></span> users and each one must put in <span class="per_user_amount"></span> sats, you need to deposit <span class="num_of_users"></span> * <span class="per_user_amount"></span> sats, plus a bit extra to pay a mining fee for the *initial transaction.* Therefore, please deposit <span class="amount_to_deposit"></span> sats to the address that will appear in your console after you click the button below.
            </p>
            <p><button class="do_initial_transaction">Do initial transaction</button></p>
        </div>
        <div class="part_3 hidden">
            <p>The factory address</p>
            <p class="multisig"></p>
            <p>The initial transaction</p>
            <p class="initial_transaction"></p>
            <p>
                The transaction above gives all your users their money. Broadcast it and then it will be time to have them fund the factory address via a coinjoin. Click the button below to prepare the coinjoin.
            </p>
            <p><button class="do_coinjoin">Do coinjoin</button></p>
        </div>
        <div class="keys hidden"><h2>Users:</h2></div>
        <script>
            var funding_amount = null;
            var num_of_users = null;
            var address_type = "regtest";
            var keys = [];
            var pubkeys = [];
            var scripts = [];
            var tree = [];
            var backup_pubkey = "a".repeat( 64 );
            var multisig = null;
            var initial_transaction = null;
            var coinjoin = null;
            var midstate_scripts = [];
            var midstate_trees = [];
            var midstate_addresses = [];
            var rounds = [];
            var round_sigs = [];
            var user_addresses = [];
            var user_ejection_sigs = [];
            var average_bytesize_of_each_users_input = 200;
            var tx_fee_for_initial_tx = null;
            var amount_per_user_to_cover_p2a_costs = 240 * 2;
            var current_round = 0;
            var connector_utxos = [];
            var connector_sigs = [];
            var withdrawal_txids = [];
            //in a pool with 10 users and a 10k funding amount, each user needs 10100 sats (the extra 100 is to pay for the coinjoin); but in this demo, in order to avoid funding each user separately, I fund them all at once in the same transaction. So that transaction needs to spend an input containing 101000 sats, plus an extra 1k sats to pay its own fee.
            var amount_to_deposit = null;
            $( '.start_tornado_factory' ).onclick = () => {
                prepTornadoFactory();
                var names = [];
                var i; for ( i=0; i<num_of_users; i++ ) names.push( generateName( names ) );
                names.sort();
                var i; for ( i=0; i<num_of_users; i++ ) {
                    var name = names[ i ];
                    var html = `
                        <div class="user">
                            <div class="profile_pic"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/2c/Default_pfp.svg/240px-Default_pfp.svg.png"></div>
                            <p><span class="username">${name}</span></p>
                            <p>On chain balance:</p>
                            <p><span class="on_chain_balance">0</span> sats</p>
                            <p>Off chain balance:</p>
                            <p><span class="off_chain_balance">0</span> sats</p>
                            <p>Address:</p>
                            <p><span class="user_${i + 1}_key">${tapscript.Address.fromScriptPubKey( [ 1, pubkeys[ i ] ], address_type )}</span></p>
                            <p><button class="eject_user" data-usernum="${i}" disabled>Eject this user</button></p>
                        </div>
                    `;
                    $( '.keys' ).innerHTML = $( '.keys' ).innerHTML + html;
                }
                $( '.welcome' ).classList.add( "hidden" );
                $$( '.num_of_users' ).forEach( item => item.innerText = num_of_users );
                $$( '.per_user_amount' ).forEach( item => item.innerText = funding_amount + average_bytesize_of_each_users_input + amount_per_user_to_cover_p2a_costs );
                $( '.amount_to_deposit' ).innerText = ( ( funding_amount + average_bytesize_of_each_users_input ) * num_of_users ) + tx_fee_for_initial_tx + ( amount_per_user_to_cover_p2a_costs * num_of_users );
                $( '.part_2' ).classList.remove( "hidden" );
                $( '.keys' ).classList.remove( "hidden" );
                $$( '.eject_user' ).forEach( item => item.onclick = e => {ejectUser( e );});
            }
            $( '.do_initial_transaction' ).onclick = async () => {
                $( '.part_2' ).classList.add( "hidden" );
                $( '.keys' ).classList.add( "hidden" );
                $( '.loading' ).classList.remove( "hidden" );
                await waitSomeTime( 10 );
                await doInitialTransaction();
                $( '.loading' ).classList.add( "hidden" );
                $( '.multisig' ).innerText = multisig;
                $( '.initial_transaction' ).innerText = initial_transaction;
                $$( '.user .on_chain_balance' ).forEach( item => item.innerText = funding_amount + average_bytesize_of_each_users_input + amount_per_user_to_cover_p2a_costs );
                $( '.part_3' ).classList.remove( "hidden" );
                $( '.keys' ).classList.remove( "hidden" );
            }
            $( '.do_coinjoin' ).onclick = () => {
                doCoinjoin();
                $$( '.user .on_chain_balance' ).forEach( item => item.innerText = 0 );
                $$( '.user .off_chain_balance' ).forEach( item => item.innerText = funding_amount );
                $$( '.user .eject_user' ).forEach( item => item.disabled = false );
            }
            var ejectUser = e => {
                var user = Number( e.target.getAttribute( "data-usernum" ) );
                e.target.parentElement.parentElement.style.backgroundColor = "pink";
                e.target.parentElement.parentElement.getElementsByClassName( "off_chain_balance" )[ 0 ].innerText = 0;
                e.target.parentElement.parentElement.getElementsByClassName( "on_chain_balance" )[ 0 ].innerText = funding_amount;
                e.target.disabled = true;
                var round = current_round;
                var tapleaf = tree[ 0 ];
                var [ _, cblock ] = tapscript.Tap.getPubKey( backup_pubkey, { target: tapleaf, tree });
                rounds[ round ].vin[ 0 ].witness = [ ...round_sigs[ round ].reverse(), scripts[ 0 ], cblock ];

                //to spend from the user's branch, get a utxo that you can pay the mining fee with
                var users_addy = tapscript.Address.fromScriptPubKey( [ 1, pubkeys[ user ] ], address_type );
                user_addresses.push( users_addy );
                var fee_for_round = 2 * num_of_users * average_bytesize_of_each_users_input;
                console.log( `please send ${fee_for_round} sats to this address:` );
                console.log( users_addy );
                var txid2 = prompt( `You are about to eject the user you selected. Please send ${fee_for_round} sats to the address in your console so that your user can pay the mining fee for their exit transaction, then enter the txid of your deposit` );
                var vout2 = Number( prompt( `and the vout` ) );
                var amnt2 = Number( prompt( `and the amount` ) );

                var round_fee_tx = tapscript.Tx.create({
                    version: 3,
                    vin: [{
                        txid: tapscript.Tx.util.getTxid( rounds[ round ] ),
                        vout: 0,
                        prevout: rounds[ round ].vout[ 0 ],
                    },{
                        txid: txid2,
                        vout: vout2,
                        prevout: {
                            value: amnt2,
                            scriptPubKey: [ 1, pubkeys[ user ] ],
                        }
                    }],
                    vout: [{
                        value: ( num_of_users * average_bytesize_of_each_users_input ) - 240,
                        scriptPubKey: [ 1, pubkeys[ user ] ],
                    }],
                });

                //sign for the input that pays the round fee
                var sig = tapscript.Signer.taproot.sign( keys[ user ], round_fee_tx, 1 ).hex;
                round_fee_tx.vin[ 1 ].witness = [ sig ];

                var eject_user_tx = tapscript.Tx.create({
                    version: 3,
                    vin: [{
                        txid: tapscript.Tx.util.getTxid( rounds[ round ] ),
                        vout: 1,
                        prevout: rounds[ round ].vout[ 1 ],
                    }],
                    vout: [{
                        value: 240,
                        scriptPubKey: "51024e73",
                    },{
                        //note that the round made an output of funding_amount - 240
                        //and this tx is spending that and taking out an *additional*
                        //240 for output 0 -- so it's funding_amount - 240 - 240
                        //todo: change the scriptPubKey to a 2 of 2 multisig with a
                        //routing node
                        value: funding_amount + amount_per_user_to_cover_p2a_costs - 240 - 240,
                        scriptPubKey: tapscript.Address.toScriptPubKey( "tb1pj0rkn0qvvc5yg876qzh5ee56dutprku826ps3uantpx4vx3mujnq3u6uhm" ),
                    }],
                });
                eject_user_tx.vin.push( connector_utxos[ user ] );
                var eject_user_sigs = user_ejection_sigs[ round ][ user ].reverse();
                var my_connector_sigs = connector_sigs[ round ][ user ].reverse();
                var tapleaf = midstate_trees[ round ][ user ];
                var [ _, cblock ] = tapscript.Tap.getPubKey( backup_pubkey, { target: tapleaf, tree: midstate_trees[ round ] });
                eject_user_tx.vin[ 0 ].witness = [ ...eject_user_sigs, midstate_scripts[ round ][ user ], cblock ];
                var [ _, cblock ] = tapscript.Tap.getPubKey( backup_pubkey, { target: tree[ 0 ], tree: tree });
                eject_user_tx.vin[ 1 ].witness = [ ...my_connector_sigs, scripts[ 0 ], cblock ];

                var exit_fee_tx = tapscript.Tx.create({
                    version: 3,
                    vin: [{
                        txid: tapscript.Tx.util.getTxid( eject_user_tx ),
                        vout: 0,
                        prevout: eject_user_tx.vout[ 0 ],
                    },{
                        txid: tapscript.Tx.util.getTxid( round_fee_tx ),
                        vout: 0,
                        prevout: round_fee_tx.vout[ 0 ],
                    }],
                    vout: [{
                        value: 0,
                        scriptPubKey: [ "OP_RETURN", "" ],
                    }],
                });

                //sign for the input that pays the exit fee
                var sig = tapscript.Signer.taproot.sign( keys[ user ], exit_fee_tx, 1 ).hex;
                exit_fee_tx.vin[ 1 ].witness = [ sig ];

                //show the user the raw transaction hex for creating the midstate
                var txhex = tapscript.Tx.encode( rounds[ round ] ).hex;
                console.log( `broadcast this round_${round} tx that lets any user leave:` );
                console.log( txhex );

                //show the user the raw transaction hex for paying the round fee
                var txhex = tapscript.Tx.encode( round_fee_tx ).hex;
                console.log( `broadcast this round_fee_tx tx that pays the fee for this round:` );
                console.log( txhex );
                console.log( `then wait for the round transaction and the round_fee_tx to confirm` );

                //show the user the raw transaction hex for ejecting whoever they picked to eject
                var txhex = tapscript.Tx.encode( eject_user_tx ).hex;
                console.log( `broadcast this eject_user_tx that ejects the user you selected:` );
                console.log( txhex );

                //show the user the raw transaction hex for paying the exit fee
                var txhex = tapscript.Tx.encode( exit_fee_tx ).hex;
                console.log( `broadcast this exit_fee_tx tx that pays the fee for the eject_user_tx:` );
                console.log( txhex );
                current_round = round + 1;
            }
            var doCoinjoin = () => {
                keys.forEach( ( privkey, index ) => {
                    var sig = tapscript.Signer.taproot.sign( privkey, coinjoin, index ).hex;
                    coinjoin.vin[ index ].witness = [ sig ];
                });
                var txhex = tapscript.Tx.encode( coinjoin ).hex;
                console.log( `broadcast this coinjoin that funds the factory address:` );
                console.log( txhex );
            }
            var prepTornadoFactory = async () => {
                //set the variables
                num_of_users = Number( prompt( `Enter how many people you want to have in this channel factory. Note that the maximum is 30.` ) );
                funding_amount = Number( prompt( `Enter how many sats you want each party to have in their channel. Note that each party will get the same amount.` ) );
                tx_fee_for_initial_tx = num_of_users * average_bytesize_of_each_users_input;
                amount_to_deposit = ( ( funding_amount + average_bytesize_of_each_users_input ) * num_of_users ) + tx_fee_for_initial_tx + ( amount_per_user_to_cover_p2a_costs * num_of_users );

                //make a 10 of 10 multisig
                var i; for ( i=0; i<num_of_users; i++ ) keys.push( bytesToHex( nobleSecp256k1.utils.randomPrivateKey() ) );
                keys.forEach( ( key, index ) => {
                    var pubkey = nobleSecp256k1.getPublicKey( key, true ).substring( 2 );
                    pubkeys.push( pubkey );
                });
                var script = [];
                pubkeys.forEach( ( key, index ) => {
                    script.push( key );
                    if ( !index ) script.push( "OP_CHECKSIG" );
                    else script.push( "OP_CHECKSIGADD" );
                });
                script.push( pubkeys.length, "OP_EQUAL" );
                scripts.push( script );
                tree = scripts.map( s => tapscript.Tap.encodeScript( s ) );
                var tapleaf = tree[ 0 ];
                var [ tpubkey ] = tapscript.Tap.getPubKey( backup_pubkey, { target: tapleaf, tree });
                multisig = tapscript.Address.p2tr.fromPubKey( tpubkey, address_type );

                //prepare the midstate scripts
                var i; for ( i=0; i<num_of_users; i++ ) {
                    if ( !i ) {
                        console.log( `0 out of ${num_of_users}` );
                        console.log( `1 out of ${num_of_users}` );
                    }
                    else if ( i === num_of_users - 1 ) console.log( 'done!' );
                    else console.log( `${i + 1} out of ${num_of_users}` );
                    var scripts_for_this_midstate = [];
                    var j; for ( j=0; j<num_of_users; j++ ) {
                        var midstate_script = JSON.parse( JSON.stringify( script ) );
                        scripts_for_this_midstate.push( midstate_script );
                    }
                    midstate_scripts.push( scripts_for_this_midstate );
                }

                //prepare the midstate addresses
                midstate_scripts.forEach( scripts => {
                    var midstate_tree = scripts.map( s => tapscript.Tap.encodeScript( s ) );
                    midstate_trees.push( midstate_tree );
                    var [ tpubkey ] = tapscript.Tap.getPubKey( backup_pubkey, { tree: midstate_tree });
                    var midstate_address = tapscript.Address.p2tr.fromPubKey( tpubkey, address_type );
                    midstate_addresses.push( midstate_address );
                });
            }
            var doInitialTransaction = async () => {
                //make a 1 of 1 address
                var privkey = bytesToHex( nobleSecp256k1.utils.randomPrivateKey() );
                var pubkey = nobleSecp256k1.getPublicKey( privkey, true ).substring( 2 );
                var address = tapscript.Address.fromScriptPubKey( [ 1, pubkey ], address_type );
                console.log( `send ${amount_to_deposit} sats to this address` );
                console.log( address );

                //send money from the 1 of 1 address to all the users
                var txid = prompt( `send ${amount_to_deposit} to the address in your console and enter the txid of your deposit` );
                var vout = Number( prompt( `and the vout` ) );
                var amnt = Number( prompt( `and the amount` ) );
                var outputs = [];
                pubkeys.forEach( pubkey => {
                    outputs.push({
                        value: funding_amount + average_bytesize_of_each_users_input + amount_per_user_to_cover_p2a_costs,
                        scriptPubKey: [ 1, pubkey ],
                    });
                });
                var txdata = tapscript.Tx.create({
                    vin: [{
                        txid,
                        vout,
                        prevout: {
                            value: amnt,
                            scriptPubKey: tapscript.Address.toScriptPubKey( address ),
                        }
                    }],
                    vout: outputs,
                });
                var sig = tapscript.Signer.taproot.sign( privkey, txdata, 0 ).hex;
                txdata.vin[ 0 ].witness = [ sig ];
                var txhex = tapscript.Tx.encode( txdata ).hex;
                console.log( `broadcast this tx that gives every user ${funding_amount + average_bytesize_of_each_users_input + amount_per_user_to_cover_p2a_costs} sats:` );
                console.log( txhex );
                initial_transaction = txhex;

                //prepare a coinjoin that funds the multisig with 10k sats apiece
                var txid = tapscript.Tx.util.getTxid( txdata );
                var vin = [];
                txdata.vout.forEach( ( prevout, vout ) => vin.push({
                    txid,
                    vout,
                    prevout,
                }) );
                coinjoin = tapscript.Tx.create({
                    vin,
                    vout: [{
                        value: ( funding_amount * num_of_users ) + ( amount_per_user_to_cover_p2a_costs * num_of_users ),
                        scriptPubKey: tapscript.Address.toScriptPubKey( multisig ),
                    }],
                });

                //Before the users share their coinjoin sigs with one another, they generate n presigned txs, to which each user gets a copy.
                var i; for ( i=0; i<num_of_users; i++ ) {
                    var txid = rounds.length ? tapscript.Tx.util.getTxid( rounds[ rounds.length - 1 ] ) : tapscript.Tx.util.getTxid( coinjoin );
                    var round = tapscript.Tx.create({
                        version: 3,
                        vin: [{
                            txid,
                            vout: rounds.length ? 2 : 0,
                            prevout: rounds.length ? rounds[ rounds.length - 1 ].vout[ 2 ] : coinjoin.vout[ 0 ],
                        }],
                        vout: [{
                            value: 240,
                            scriptPubKey: "51024e73",
                        },{
                            value: funding_amount + amount_per_user_to_cover_p2a_costs - 330 - 240,
                            scriptPubKey: tapscript.Address.toScriptPubKey( midstate_addresses[ i ] ),
                        }],
                    });
                    if ( i !== num_of_users - 1 ) {
                        round.vout.push({
                            value: ( funding_amount * num_of_users ) + ( amount_per_user_to_cover_p2a_costs * num_of_users ) - ( funding_amount * ( i + 1 ) ) - ( amount_per_user_to_cover_p2a_costs * ( i + 1 ) ) - ( 330 * num_of_users ),
                            scriptPubKey: tapscript.Address.toScriptPubKey( multisig ),
                        });
                    }
                    if ( !i ) {
                        var j; for ( j=0; j<num_of_users; j++ ) {
                            round.vout.push({
                                value: 330,
                                scriptPubKey: tapscript.Address.toScriptPubKey( multisig ),
                            });
                        }
                    }
                    if ( !i ) {
                        var j; for ( j=0; j<num_of_users; j++ ) {
                            connector_utxos.push({
                                txid: tapscript.Tx.util.getTxid( round ),
                                vout: j + 3,
                                prevout: round.vout[ j + 3 ],
                            });
                        }
                    }
                    var sigs = [];
                    var tapleaf = tree[ 0 ];
                    keys.forEach( ( key, index ) => {
                        var sig = tapscript.Signer.taproot.sign( key, round, 0, { extension: tapleaf }).hex;
                        sigs.push( sig );
                    });
                    rounds.push( round );
                    round_sigs.push( sigs );
                }

                //allow each user to unilaterally exit in each round
                //each user needs the ability to withdraw from the midstate in any round
                //therefore, I must make n*n*n sigs -- there are n users who need to exit
                //and n rounds to exit in, and each user, in order to exit in that round,
                //needs n sigs
                //each key needs to sign n*n ejection transactions
                //the ejection transaction is different for each user
                //in each round so let's make the other two loops
                var totalnum = 0;
                var i; for ( i=0; i<num_of_users; i++ ) {
                    if ( !i ) console.log( `0 out of ${( num_of_users ** 3 ) * 2} signatures created` );
                    //in the codeblock beginning above, i represents a round
                    var all_ejection_sigs_for_this_round = [];
                    var all_connector_sigs_for_this_round = [];
                    var all_withdrawal_txids_for_this_round = [];
                    var j; for ( j=0; j<num_of_users; j++ ) {
                        //in the codeblock beginning above, j represents a user
                        var eject_user_tx = tapscript.Tx.create({
                            version: 3,
                            vin: [{
                                txid: tapscript.Tx.util.getTxid( rounds[ i ] ),
                                vout: 1,
                                prevout: rounds[ i ].vout[ 1 ],
                            }],
                            vout: [{
                                value: 240,
                                scriptPubKey: "51024e73",
                            },{
                                //note that the round made an output of funding_amount - 240
                                //and this tx is spending that and taking out an *additional*
                                //240 for output 0 -- so it's funding_amount - 240 - 240
                                //todo: change the scriptPubKey to a 2 of 2 multisig with a
                                //routing node
                                value: funding_amount + amount_per_user_to_cover_p2a_costs - 240 - 240,
                                scriptPubKey: tapscript.Address.toScriptPubKey( "tb1pj0rkn0qvvc5yg876qzh5ee56dutprku826ps3uantpx4vx3mujnq3u6uhm" ),
                            }],
                        });
                        eject_user_tx.vin.push( connector_utxos[ j ] );
                        var txid_of_this_withdrawal_tx = tapscript.Tx.util.getTxid( eject_user_tx );
                        all_withdrawal_txids_for_this_round.push( txid_of_this_withdrawal_tx );
                        //I will use the tapleaf that lets one user alone leave after revealing his or her first withdrawal secret
                        //in round 1, the tapleaf I need for the first user is midstate_trees[ 0 ][ 0 ]
                        //in round 1, the tapleaf I need for the second user is midstate_trees[ 0 ][ 1 ]
                        //etc.
                        //in round 2, the tapleaf I need for the first user is midstate_trees[ 1 ][ 0 ]
                        //in round 2, the tapleaf I need for the second user is midstate_trees[ 1 ][ 1 ]
                        //etc.
                        var midstate_tapleaf = midstate_trees[ i ][ j ];
                        var connector_tapleaf = tree[ 0 ];
                        var [ _, cblock ] = tapscript.Tap.getPubKey( backup_pubkey, { target: tapleaf, tree: midstate_trees[ i ] });
                        var sigs_for_this_user_for_this_round = [];
                        var connector_sigs_for_this_user_for_this_round = [];
                        keys.forEach( ( privkey, index ) => {
                            var sig = tapscript.Signer.taproot.sign( privkey, eject_user_tx, 0, { extension: midstate_tapleaf } ).hex;
                            totalnum = totalnum + 1;
                            console.log( `${totalnum} out of ${( num_of_users ** 3 ) * 2} signatures created` );
                            sigs_for_this_user_for_this_round.push( sig );
                            var connector_sig = tapscript.Signer.taproot.sign( privkey, eject_user_tx, 1, { extension: connector_tapleaf } ).hex;
                            totalnum = totalnum + 1;
                            console.log( `${totalnum} out of ${( num_of_users ** 3 ) * 2} signatures created` );
                            connector_sigs_for_this_user_for_this_round.push( connector_sig );
                        });
                        all_ejection_sigs_for_this_round.push( sigs_for_this_user_for_this_round );
                        all_connector_sigs_for_this_round.push( connector_sigs_for_this_user_for_this_round );
                    }
                    if ( i === num_of_users - 1 ) console.log( 'done!' );
                    user_ejection_sigs.push( all_ejection_sigs_for_this_round );
                    connector_sigs.push( all_connector_sigs_for_this_round );
                    withdrawal_txids.push( all_withdrawal_txids_for_this_round );
                }
            }
        </script>
    </body>
</html>
